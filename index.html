<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Jackx Project Chess</title>

<script src="https://unpkg.com/chess.js@0.13.4/chess.min.js"></script>

<style>
body{
 margin:0;
 height:100vh;
 display:flex;
 flex-direction:column;
 align-items:center;
 justify-content:center;
 background:linear-gradient(135deg,#0f172a,#020617);
 font-family:Segoe UI;
 color:white;
}

h1{
 margin-bottom:5px;
 letter-spacing:2px;
}

#board{
 display:grid;
 grid-template-columns:repeat(8,80px);
 grid-template-rows:repeat(8,80px);
 border:4px solid #38bdf8;
 box-shadow:0 0 40px #0ea5e9;
}

.square{
 width:80px;
 height:80px;
 display:flex;
 align-items:center;
 justify-content:center;
 font-size:42px;
 cursor:pointer;
}

.white{ background:#e2e8f0; color:black; }
.black{ background:#1e293b; }

.highlight{ background:#22c55e !important; }
.check{ background:#ef4444 !important; }

#panel{
 margin-top:20px;
 text-align:center;
}

button,select{
 padding:10px 18px;
 margin:5px;
 border:none;
 border-radius:10px;
 background:#0ea5e9;
 color:white;
 font-weight:bold;
 cursor:pointer;
}

.footer{
 margin-top:10px;
 font-size:12px;
 opacity:.7;
}
</style>
</head>

<body>

<h1>♟ JACKX PROJECT CHESS ♟</h1>

<div id="board"></div>

<div id="panel">
<select id="mode">
<option value="pvp">1v1 Player</option>
<option value="ai">VS AI</option>
</select>

<select id="difficulty">
<option value="1">Easy</option>
<option value="2">Normal</option>
<option value="3">Hard</option>
<option value="4">Very Hard</option>
<option value="5">MAX</option>
</select>

<br>
<button onclick="resetGame()">Reset Game</button>
<div id="status">Game Ready</div>
<div class="footer">by: jackx project</div>
</div><script>

const game = new Chess();
let selected = null;
let legalMoves = [];

const moveSound = new Audio("dimakan.mp3");
const mateSound = new Audio("skakmat.mp3");
const aiWinSound = new Audio("AI WIN.mp3");
const playerWinSound = new Audio("player win.mp3");

const board = document.getElementById("board");

function drawBoard(){
 board.innerHTML="";
 const state = game.board();

 for(let r=0;r<8;r++){
  for(let c=0;c<8;c++){
   const sq=document.createElement("div");
   sq.className=`square ${(r+c)%2==0?"white":"black"}`;
   sq.dataset.square=String.fromCharCode(97+c)+(8-r);

   const piece=state[r][c];
   if(piece){
    sq.textContent=getPiece(piece);
   }

   sq.onclick=()=>onClick(sq.dataset.square);
   board.appendChild(sq);
  }
 }
}

function getPiece(p){
 const map={
  p:"♟",r:"♜",n:"♞",b:"♝",q:"♛",k:"♚"
 };
 return p.color==="w"?map[p.type].toUpperCase():map[p.type];
}

function onClick(square){

 if(selected){
  const move=game.move({from:selected,to:square,promotion:"q"});

  if(move){
   if(move.captured) moveSound.play();
   selected=null;
   legalMoves=[];
   drawBoard();
   checkGameState();

   if(isAIMode() && !game.game_over()){
    setTimeout(aiMove,300);
   }
   return;
  }
 }

 const moves=game.moves({square,verbose:true});
 if(moves.length){
  selected=square;
  legalMoves=moves.map(m=>m.to);
 }
}

function isAIMode(){
 return document.getElementById("mode").value==="ai";
}function aiMove(){
 const depth=parseInt(document.getElementById("difficulty").value);
 const move=minimaxRoot(depth,game,true);
 game.move(move);
 drawBoard();
 checkGameState();
}

function minimaxRoot(depth,game,isMax){
 const moves=game.moves();
 let bestMove=-9999;
 let bestMoveFound=null;

 for(let i=0;i<moves.length;i++){
  game.move(moves[i]);
  const value=minimax(depth-1,game,-10000,10000,!isMax);
  game.undo();

  if(value>=bestMove){
   bestMove=value;
   bestMoveFound=moves[i];
  }
 }
 return bestMoveFound;
}

function minimax(depth,game,alpha,beta,isMax){
 if(depth===0) return -evaluateBoard(game.board());

 const moves=game.moves();

 if(isMax){
  let best=-9999;
  for(let i=0;i<moves.length;i++){
   game.move(moves[i]);
   best=Math.max(best,minimax(depth-1,game,alpha,beta,false));
   game.undo();
   alpha=Math.max(alpha,best);
   if(beta<=alpha) return best;
  }
  return best;
 }else{
  let best=9999;
  for(let i=0;i<moves.length;i++){
   game.move(moves[i]);
   best=Math.min(best,minimax(depth-1,game,alpha,beta,true));
   game.undo();
   beta=Math.min(beta,best);
   if(beta<=alpha) return best;
  }
  return best;
 }
}

function evaluateBoard(board){
 let total=0;
 const values={p:100,r:500,n:320,b:330,q:900,k:20000};

 for(let r=0;r<8;r++){
  for(let c=0;c<8;c++){
   const piece=board[r][c];
   if(piece){
    total+=piece.color==="w"?values[piece.type]:-values[piece.type];
   }
  }
 }
 return total;
}

function checkGameState(){
 const status=document.getElementById("status");

 if(game.in_checkmate()){
  mateSound.play();

  if(game.turn()==="w"){
   aiWinSound.play();
   status.textContent="AI WIN";
  }else{
   playerWinSound.play();
   status.textContent="PLAYER WIN";
  }
  return;
 }

 if(game.in_draw()){
  status.textContent="DRAW";
  return;
 }

 status.textContent=(game.turn()==="w"?"White":"Black")+" Turn";
}

function resetGame(){
 game.reset();
 drawBoard();
}

window.onload=()=>drawBoard();

</script>
</body>
</html>
